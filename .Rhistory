return(rbinom(1,1,chance))
}
data$hypertension <- apply(data, get_hypertension, MARGIN = 1)
mean(data$hypertension)
model <- glm(hypertension~., data = data, family = "binomial")
summary(model)
get_hypertension <- function(x){
#typeof(x["smoker"])
chance <- (as.numeric(x["age"])/350 + as.logical(x["smoker"])*0.15 +
as.numeric(x["no_cigarettes"])*0.022 + (x["sex"] == "m") * 0.15 +
as.numeric(x["bmi"])/100 - 0.25)
if(chance > 1){
chance <- 1
}
return(rbinom(1,1,chance))
}
data$hypertension <- apply(data, get_hypertension, MARGIN = 1)
mean(data$hypertension)
model <- glm(hypertension~., data = data, family = "binomial")
summary(model)
get_hypertension <- function(x){
#typeof(x["smoker"])
chance <- (as.numeric(x["age"])/350 + as.logical(x["smoker"])*0.18 +
as.numeric(x["no_cigarettes"])*0.025 + (x["sex"] == "m") * 0.18 +
as.numeric(x["bmi"])/80 - 0.3)
if(chance > 1){
chance <- 1
}
return(rbinom(1,1,chance))
}
data$hypertension <- apply(data, get_hypertension, MARGIN = 1)
mean(data$hypertension)
model <- glm(hypertension~., data = data, family = "binomial")
summary(model)
data$age/500
get_hypertension <- function(x){
#typeof(x["smoker"])
chance <- (as.numeric(x["age"])/500 + as.logical(x["smoker"])*0.18 +
as.numeric(x["no_cigarettes"])*0.025 + (x["sex"] == "m") * 0.18 +
as.numeric(x["bmi"])/80 - 0.3)
if(chance > 1){
chance <- 1
}
return(rbinom(1,1,chance))
}
data$hypertension <- apply(data, get_hypertension, MARGIN = 1)
mean(data$hypertension)
model <- glm(hypertension~., data = data, family = "binomial")
summary(model)
get_hypertension <- function(x){
#typeof(x["smoker"])
chance <- (as.numeric(x["age"])/500 + as.logical(x["smoker"])*0.2 +
as.numeric(x["no_cigarettes"])*0.025 + (x["sex"] == "m") * 0.2 +
as.numeric(x["bmi"])/50 - 0.35)
if(chance > 1){
chance <- 1
}
return(rbinom(1,1,chance))
}
data$hypertension <- apply(data, get_hypertension, MARGIN = 1)
mean(data$hypertension)
model <- glm(hypertension~., data = data, family = "binomial")
summary(model)
get_hypertension <- function(x){
#typeof(x["smoker"])
chance <- (as.numeric(x["age"])/500 + as.logical(x["smoker"])*0.2 +
as.numeric(x["no_cigarettes"])*0.025 + (x["sex"] == "m") * 0.2 +
as.numeric(x["bmi"])/70 - 0.35)
if(chance > 1){
chance <- 1
}
return(rbinom(1,1,chance))
}
data$hypertension <- apply(data, get_hypertension, MARGIN = 1)
mean(data$hypertension)
model <- glm(hypertension~., data = data, family = "binomial")
summary(model)
get_hypertension <- function(x){
#typeof(x["smoker"])
chance <- (as.numeric(x["age"])/500 + as.logical(x["smoker"])*0.2 +
as.numeric(x["no_cigarettes"])*0.025 + (x["sex"] == "m") * 0.2 +
as.numeric(x["bmi"])/70 - 0.4)
if(chance > 1){
chance <- 1
}
return(rbinom(1,1,chance))
}
data$hypertension <- apply(data, get_hypertension, MARGIN = 1)
mean(data$hypertension)
model <- glm(hypertension~., data = data, family = "binomial")
summary(model)
get_hypertension <- function(x){
#typeof(x["smoker"])
chance <- (as.numeric(x["age"])/500 + as.logical(x["smoker"])*0.2 +
as.numeric(x["no_cigarettes"])*0.025 + (x["sex"] == "m") * 0.25 +
as.numeric(x["bmi"])/65 - 0.4)
if(chance > 1){
chance <- 1
}
return(rbinom(1,1,chance))
}
data$hypertension <- apply(data, get_hypertension, MARGIN = 1)
mean(data$hypertension)
model <- glm(hypertension~., data = data, family = "binomial")
summary(model)
get_hypertension <- function(x){
#typeof(x["smoker"])
chance <- (as.numeric(x["age"])/500 + as.logical(x["smoker"])*0.2 +
as.numeric(x["no_cigarettes"])*0.025 + (x["sex"] == "m") * 0.25 +
as.numeric(x["bmi"])/65 - 0.45)
if(chance > 1){
chance <- 1
}
return(rbinom(1,1,chance))
}
data$hypertension <- apply(data, get_hypertension, MARGIN = 1)
mean(data$hypertension)
model <- glm(hypertension~., data = data, family = "binomial")
summary(model)
get_hypertension <- function(x){
#typeof(x["smoker"])
chance <- (as.numeric(x["age"])/500 + as.logical(x["smoker"])*0.25 +
as.numeric(x["no_cigarettes"])*0.025 + (x["sex"] == "m") * 0.3 +
as.numeric(x["bmi"])/60 - 0.7)
if(chance > 1){
chance <- 1
}
return(rbinom(1,1,chance))
}
data$hypertension <- apply(data, get_hypertension, MARGIN = 1)
mean(data$hypertension)
model <- glm(hypertension~., data = data, family = "binomial")
summary(model)
get_hypertension <- function(x){
#typeof(x["smoker"])
chance <- (as.numeric(x["age"])/450 + as.logical(x["smoker"])*0.25 +
as.numeric(x["no_cigarettes"])*0.025 + (x["sex"] == "m") * 0.3 +
as.numeric(x["bmi"])/60 - 0.7)
if(chance > 1){
chance <- 1
}
return(rbinom(1,1,chance))
}
data$hypertension <- apply(data, get_hypertension, MARGIN = 1)
mean(data$hypertension)
model <- glm(hypertension~., data = data, family = "binomial")
summary(model)
get_hypertension <- function(x){
#typeof(x["smoker"])
chance <- (as.numeric(x["age"])/450 + as.logical(x["smoker"])*0.25 +
as.numeric(x["no_cigarettes"])*0.025 + (x["sex"] == "m") * 0.3 +
as.numeric(x["bmi"])/60 - 0.7)
print(chance)
if(chance > 1){
chance <- 1
}
return(rbinom(1,1,chance))
}
data$hypertension <- apply(data, get_hypertension, MARGIN = 1)
get_hypertension <- function(x){
#typeof(x["smoker"])
chance <- (as.numeric(x["age"])/400 + as.logical(x["smoker"])*0.3 +
as.numeric(x["no_cigarettes"])*0.03 + (x["sex"] == "m") * 0.35 +
as.numeric(x["bmi"])/50 - 0.9)
print(chance)
if(chance > 1){
chance <- 1
}
return(rbinom(1,1,chance))
}
data$hypertension <- apply(data, get_hypertension, MARGIN = 1)
get_hypertension <- function(x){
#typeof(x["smoker"])
chance <- (as.numeric(x["age"])/400 + as.logical(x["smoker"])*0.3 +
as.numeric(x["no_cigarettes"])*0.03 + (x["sex"] == "m") * 0.35 +
as.numeric(x["bmi"])/50 - 0.9)
print(chance)
if(chance > 1){
chance <- 1
} elseif(chance < 0){
chance <- 0
}
return(rbinom(1,1,chance))
}
data$hypertension <- apply(data, get_hypertension, MARGIN = 1)
print(chance)
rbinom(1,1,chance)
get_hypertension <- function(x){
#typeof(x["smoker"])
chance <- (as.numeric(x["age"])/400 + as.logical(x["smoker"])*0.3 +
as.numeric(x["no_cigarettes"])*0.03 + (x["sex"] == "m") * 0.35 +
as.numeric(x["bmi"])/50 - 0.9)
print(chance)
if(chance > 1){
chance <- 1
} elseif(chance < 0){
chance <- 0
}
print(chance)
return(rbinom(1,1,chance))
}
get_hypertension <- function(x){
#typeof(x["smoker"])
chance <- (as.numeric(x["age"])/400 + as.logical(x["smoker"])*0.3 +
as.numeric(x["no_cigarettes"])*0.03 + (x["sex"] == "m") * 0.35 +
as.numeric(x["bmi"])/50 - 0.9)
print(chance)
if(chance > 1){
chance <- 1
} elseif(chance < 0){
chance <- 0
}
print(chance)
return(rbinom(1,1,chance))
}
get_hypertension <- function(x){
#typeof(x["smoker"])
chance <- (as.numeric(x["age"])/400 + as.logical(x["smoker"])*0.3 +
as.numeric(x["no_cigarettes"])*0.03 + (x["sex"] == "m") * 0.35 +
as.numeric(x["bmi"])/50 - 0.9)
print(chance)
if(chance > 1){
chance <- 1
} else if(chance < 0){
chance <- 0
}
print(chance)
return(rbinom(1,1,chance))
}
data$hypertension <- apply(data, get_hypertension, MARGIN = 1)
mean(data$hypertension)
model <- glm(hypertension~., data = data, family = "binomial")
summary(model)
get_hypertension <- function(x){
#typeof(x["smoker"])
chance <- (as.numeric(x["age"])/350 + as.logical(x["smoker"])*0.25 +
as.numeric(x["no_cigarettes"])*0.035 + (x["sex"] == "m") * 0.35 +
as.numeric(x["bmi"])/50 - 0.9)
print(chance)
if(chance > 1){
chance <- 1
} else if(chance < 0){
chance <- 0
}
print(chance)
return(rbinom(1,1,chance))
}
data$hypertension <- apply(data, get_hypertension, MARGIN = 1)
mean(data$hypertension)
model <- glm(hypertension~., data = data, family = "binomial")
summary(model)
get_hypertension <- function(x){
#typeof(x["smoker"])
chance <- (as.numeric(x["age"])/350 + as.logical(x["smoker"])*0.25 +
as.numeric(x["no_cigarettes"])*0.035 + (x["sex"] == "m") * 0.35 +
as.numeric(x["bmi"])/50 - 0.9)
print(chance)
if(chance > 1){
chance <- 1
} else if(chance < 0){
chance <- 0
}
return(rbinom(1,1,chance))
}
get_hypertension <- function(x){
#typeof(x["smoker"])
chance <- (as.numeric(x["age"])/375 + as.logical(x["smoker"])*0.25 +
as.numeric(x["no_cigarettes"])*0.035 + (x["sex"] == "m") * 0.35 +
as.numeric(x["bmi"])/50 - 0.9)
print(chance)
if(chance > 1){
chance <- 1
} else if(chance < 0){
chance <- 0
}
return(rbinom(1,1,chance))
}
data$hypertension <- apply(data, get_hypertension, MARGIN = 1)
mean(data$hypertension)
model <- glm(hypertension~., data = data, family = "binomial")
summary(model)
get_hypertension <- function(x){
#typeof(x["smoker"])
chance <- (as.numeric(x["age"])/375 + as.logical(x["smoker"])*0.25 +
as.numeric(x["no_cigarettes"])*0.035 + (x["sex"] == "m") * 0.35 +
as.numeric(x["bmi"])/50 - 0.9)
print(chance)
if(chance > 1){
chance <- 1
} else if(chance < 0){
chance <- 0
}
return(rbinom(1,1,chance))
}
data$hypertension <- apply(data, get_hypertension, MARGIN = 1)
get_hypertension <- function(x){
#typeof(x["smoker"])
chance <- (as.numeric(x["age"])/375 + as.logical(x["smoker"])*0.25 +
as.numeric(x["no_cigarettes"])*0.035 + (x["sex"] == "m") * 0.35 +
as.numeric(x["bmi"])/50 - 0.9)
if(chance > 1){
chance <- 1
} else if(chance < 0){
chance <- 0
}
return(rbinom(1,1,chance))
}
data$hypertension <- apply(data, get_hypertension, MARGIN = 1)
mean(data$hypertension)
model <- glm(hypertension~., data = data, family = "binomial")
summary(model)
get_hypertension <- function(x){
#typeof(x["smoker"])
chance <- (as.numeric(x["age"])/375 + as.logical(x["smoker"])*0.25 +
as.numeric(x["no_cigarettes"])*0.035 + (x["sex"] == "m") * 0.35 +
as.numeric(x["bmi"])/30 - 0.9)
if(chance > 1){
chance <- 1
} else if(chance < 0){
chance <- 0
}
return(rbinom(1,1,chance))
}
data$hypertension <- apply(data, get_hypertension, MARGIN = 1)
mean(data$hypertension)
get_hypertension <- function(x){
#typeof(x["smoker"])
chance <- (as.numeric(x["age"])/375 + as.logical(x["smoker"])*0.25 +
as.numeric(x["no_cigarettes"])*0.035 + (x["sex"] == "m") * 0.35 +
as.numeric(x["bmi"])/30 - 1.1)
if(chance > 1){
chance <- 1
} else if(chance < 0){
chance <- 0
}
return(rbinom(1,1,chance))
}
data$hypertension <- apply(data, get_hypertension, MARGIN = 1)
mean(data$hypertension)
get_hypertension <- function(x){
#typeof(x["smoker"])
chance <- (as.numeric(x["age"])/375 + as.logical(x["smoker"])*0.25 +
as.numeric(x["no_cigarettes"])*0.035 + (x["sex"] == "m") * 0.35 +
as.numeric(x["bmi"])/30 - 1.4)
if(chance > 1){
chance <- 1
} else if(chance < 0){
chance <- 0
}
return(rbinom(1,1,chance))
}
data$hypertension <- apply(data, get_hypertension, MARGIN = 1)
mean(data$hypertension)
model <- glm(hypertension~., data = data, family = "binomial")
summary(model)
get_hypertension <- function(x){
#typeof(x["smoker"])
chance <- (as.numeric(x["age"])/350 + as.logical(x["smoker"])*0.25 +
as.numeric(x["no_cigarettes"])*0.035 + (x["sex"] == "m") * 0.35 +
as.numeric(x["bmi"])/30 - 1.4)
if(chance > 1){
chance <- 1
} else if(chance < 0){
chance <- 0
}
return(rbinom(1,1,chance))
}
data$hypertension <- apply(data, get_hypertension, MARGIN = 1)
mean(data$hypertension)
model <- glm(hypertension~., data = data, family = "binomial")
summary(model)
get_hypertension <- function(x){
#typeof(x["smoker"])
chance <- (as.numeric(x["age"])/360 + as.logical(x["smoker"])*0.20 +
as.numeric(x["no_cigarettes"])*0.035 + (x["sex"] == "m") * 0.35 +
as.numeric(x["bmi"])/30 - 1.4)
if(chance > 1){
chance <- 1
} else if(chance < 0){
chance <- 0
}
return(rbinom(1,1,chance))
}
data$hypertension <- apply(data, get_hypertension, MARGIN = 1)
mean(data$hypertension)
model <- glm(hypertension~., data = data, family = "binomial")
summary(model)
model <- glm(hypertension~sex + bmi + smoker + no_cigarettes + age, data = data, family = "binomial")
summary(model)
model <- glm(hypertension~sex + bmi + smoker + no_cigarettes + age + weight, data = data, family = "binomial")
summary(model)
get_hypertension <- function(x){
#typeof(x["smoker"])
chance <- (as.numeric(x["age"])/360 + as.logical(x["smoker"])*0.20 +
as.numeric(x["no_cigarettes"])*0.035 + (x["sex"] == "m") * 0.35 +
as.numeric(x["bmi"])/30 - 1.4)
if(chance > 1){
chance <- 1
} else if(chance < 0){
chance <- 0
}
return(rbinom(1,1,chance))
}
data$hypertension <- apply(data, get_hypertension, MARGIN = 1)
mean(data$hypertension)
model <- glm(hypertension~sex + bmi + smoker + no_cigarettes + age + weight, data = data, family = "binomial")
summary(model)
get_hypertension <- function(x){
#typeof(x["smoker"])
chance <- (as.numeric(x["age"])/360 + as.logical(x["smoker"])*0.20 +
as.numeric(x["no_cigarettes"])*0.035 + (x["sex"] == "m") * 0.35 +
as.numeric(x["bmi"])/30 - 1.4)
if(chance > 1){
chance <- 1
} else if(chance < 0){
chance <- 0
}
return(rbinom(1,1,chance))
}
data$hypertension <- apply(data, get_hypertension, MARGIN = 1)
mean(data$hypertension)
model <- glm(hypertension~., data = data, family = "binomial")
summary(model)
get_hypertension <- function(x){
#typeof(x["smoker"])
chance <- (as.numeric(x["age"])/360 + as.logical(x["smoker"])*0.30 +
as.numeric(x["no_cigarettes"])*0.035 + (x["sex"] == "m") * 0.35 +
as.numeric(x["bmi"])/30 - 1.4)
if(chance > 1){
chance <- 1
} else if(chance < 0){
chance <- 0
}
return(rbinom(1,1,chance))
}
data$hypertension <- apply(data, get_hypertension, MARGIN = 1)
mean(data$hypertension)
model <- glm(hypertension~., data = data, family = "binomial")
summary(model)
get_hypertension <- function(x){
#typeof(x["smoker"])
chance <- (as.numeric(x["age"])/360 + as.logical(x["smoker"])*0.30 +
as.numeric(x["no_cigarettes"])*0.035 + (x["sex"] == "m") * 0.35 +
as.numeric(x["bmi"])/30 - 1.4)
if(chance > 1){
chance <- 1
} else if(chance < 0){
chance <- 0
}
return(rbinom(1,1,chance))
}
data$hypertension <- apply(data, get_hypertension, MARGIN = 1)
mean(data$hypertension)
model <- glm(hypertension~., data = data, family = "binomial")
summary(model)
model <- lm(weight~., data = data)
summary(model)
data$bmi <- NULL
model <- lm(weight~., data = data)
summary(model)
cor(data$weight, data$height)
data <- data.frame(sex = c(rep("m",500), rep("w",500)))
data$height <- c(rnorm(500, 180,5), rnorm(500, 166, 5))
data$weight <- c(rnorm(500, 88,5), rnorm(500, 166, 5))
temp_data <- rbind(data.frame(mvrnorm(500,c(180,88), Sigma = matrix(c(25,12,12,25),nrow=2))),
data.frame(mvrnorm(500,c(166,71), Sigma = matrix(c(25,12,12,25),nrow=2))))
plot(temp_data$X1, temp_data$X2)
data$height <- temp_data$X1
data$weight <- temp_data$X2
data$age <- round(runif(1000, 25, 80),0)
data$hair_color <- sample(c("blonde", "black", "brown"), 1000, replace = T)
data$smoker <- rbinom(1000,1,.2)
data$smoker <- ifelse(data$smoker == 1, TRUE, FALSE)
data$no_cigarettes <- 0
data[data$smoker == T,]$no_cigarettes <- round(rnorm(sum(data$smoker == T),7,2),0)
data$bmi = data$weight/(data$height/100)^2
get_hypertension <- function(x){
#typeof(x["smoker"])
chance <- (as.numeric(x["age"])/360 + as.logical(x["smoker"])*0.30 +
as.numeric(x["no_cigarettes"])*0.035 + (x["sex"] == "m") * 0.35 +
as.numeric(x["bmi"])/30 - 1.4)
if(chance > 1){
chance <- 1
} else if(chance < 0){
chance <- 0
}
return(rbinom(1,1,chance))
}
data$hypertension <- apply(data, get_hypertension, MARGIN = 1)
mean(data$hypertension)
model <- glm(hypertension~., data = data, family = "binomial")
summary(model)
model <- lm(weight~., data = data)
summary(model)
cor(data$weight, data$height)
save(data, file = "data.RData")
write.csv(data, file = "data.csv")
View(data)
model <- glm(hypertension~., data = data, family = "binomial")
summary(model)
model <- lm(weight~., data = data)
summary(model)
View(data)
library(tidyverse)
spss_data <- data = read_sav("Spsskurs.sav")
install.packages("haven")
install.packages("haven")
library(haven)
spss_data <- data = read_sav("Spsskurs.sav")
spss_data <- read_sav("Spsskurs.sav")
View(spss_data)
write.csv(spss_data, "SPSS_Data.csv")
